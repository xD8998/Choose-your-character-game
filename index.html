<html>
<head>
  <title>Character Select & Game</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="game-container" class="game-container">
    <!-- Character Select Screen -->
    <div id="character-select-screen">
      <div class="background-image"></div>
      <div class="background-overlay"></div>
      <div id="character-details" class="character-details hidden"></div>
      <div class="character-select">
        <h1>Choose Your Character</h1>
        <div class="mission-brief hidden">
          <div id="level1-brief">
            <h2>Level 1: Patrick's Floppa Army</h2>
            <div class="mission-content">
              <div class="mission-image">
                <img src="/Patrick_Star.svg.png" alt="Patrick with Floppa" style="width: 200px;">
                <img src="/floppa_png-removebg-preview.png" alt="Floppa" style="width: 150px;">
              </div>
              <div class="mission-text">
                <p class="story">Patrick Star has gone mad with power! After discovering a mysterious ability to command an army of Floppas, 
                he's taken over the peaceful garden and threatens to expand his territory. His Floppa minions are causing chaos everywhere!</p>
                <p class="objective">Your Mission: Defeat Patrick Star and his army of Floppa companions before his power grows too strong!</p>
                <ul class="mission-details">
                  <li>Boss Health: 300 HP</li>
                  <li>Watch out for Floppa reinforcements!</li>
                  <li>Find weapon upgrades to increase your damage!</li>
                </ul>
              </div>
            </div>
            <button id="start-game-level1" class="start-game-button">Start Level 1</button>
          </div>

          <div id="level2-brief" class="hidden">
            <h2>Level 2: Peter's Hotel of Despair</h2>
            <div class="mission-content">
              <div class="mission-image">
                <img src="/Peter_Griffin.png" alt="Peter Griffin" style="width: 200px;">
                <img src="/trollface (2).png" alt="Trollface" style="width: 150px;">
              </div>
              <div class="mission-text">
                <p class="story">After defeating Patrick, a new threat emerges in a mysterious liminal hotel. Peter Griffin has taken control 
                of this unsettling space, using reality-bending powers to create a maze of deadly exits and Windows logos!</p>
                <p class="objective">Your Mission: Survive Peter's mind games and defeat him before you lose your sanity!</p>
                <ul class="mission-details">
                  <li>Boss Health: 500 HP</li>
                  <li>Take 3 damage per hit from Peter!</li>
                  <li>Avoid fake exits - they're instant death!</li>
                  <li>Watch out for Windows logos - they blind and damage you!</li>
                  <li>Stay above 5 HP or Windows logos become lethal!</li>
                </ul>
              </div>
            </div>
            <button id="start-game-level2" class="start-game-button">Start Level 2</button>
          </div>
          <button id="start-game" class="hidden">Start Game</button>
        </div>
        <button id="level-select-button" class="level-select-button" style="display: none;">Level Select</button>
        <div id="level-select-menu" class="level-select-menu hidden">
          <button class="close-menu">&times;</button>
          <h2>Select Level</h2>
          <button class="level-button" data-level="1">Level 1: Patrick's Floppa Army</button>
          <button class="level-button" data-level="2">Level 2: Peter's Hotel of Despair</button>
        </div>
        <div class="character-grid">
          <div class="character-card" data-character="Steve">
            <img src="/the REAL REAL STEVE.jpg" alt="Steve">
            <p>Steve</p>
          </div>
          <div class="character-card" data-character="Among Us">
            <img src="/an871k4o1sn51 (1).png" alt="Among Us">
            <p>Among Us</p>
          </div>
          <div class="character-card" data-character="Roblox Noob">
            <img src="/OIP (1).jfif" alt="Roblox Noob">
            <p>Roblox Noob</p>
          </div>
          <div class="character-card" data-character="Mario">
            <img src="/smb1 mario idle.webp" alt="Mario">
            <p>Mario</p>
          </div>
          <div class="character-card" data-character="Chill Guy" style="display: none">
            <img src="/chill-guy.webp" alt="Chill Guy">
            <p>Chill Guy</p>
            <span class="unlock-note">Special: Slows enemies to 50% speed for 3 seconds</span>
            <span class="unlock-note">(Unlocked after beating Level 2)</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Repository Screen -->
    <div id="repository-screen" class="hidden">
      <div class="background-image"></div>
      <div class="background-overlay"></div>
      <div class="repository-container">
        <h1>Enemy & Power-up Repository</h1>
        <div class="repository-tabs">
          <button class="tab-button active" data-tab="enemies">Enemies</button>
          <button class="tab-button" data-tab="powerups">Power-ups</button>
          <button class="tab-button" data-tab="traps">Traps</button>
        </div>
        
        <div class="repository-content">
          <!-- Enemies Tab -->
          <div id="enemies-tab" class="tab-content active">
            <div class="enemy-card">
              <img src="/Patrick_Star.svg.png" alt="Patrick">
              <div class="enemy-info">
                <h3>Patrick Star</h3>
                <p class="enemy-type">Boss Enemy - Level 1</p>
                <p class="enemy-stats">Health: 300 HP</p>
                <p class="enemy-stats">Attack: 2 damage/hit</p>
                <p class="enemy-description">A formidable foe who commands an army of Floppas. Known for his erratic movement patterns and ability to summon reinforcements.</p>
                <p class="enemy-tips">Strategy: Keep your distance and focus on dodging his attacks while dealing with Floppa minions.</p>
              </div>
            </div>
            
            <div class="enemy-card">
              <img src="/floppa_png-removebg-preview.png" alt="Floppa">
              <div class="enemy-info">
                <h3>Floppa Minion</h3>
                <p class="enemy-type">Regular Enemy - Level 1</p>
                <p class="enemy-stats">Health: 50 HP</p>
                <p class="enemy-stats">Attack: 0.5 damage/hit</p>
                <p class="enemy-description">Patrick's loyal companions. These fast-moving creatures chase the player relentlessly.</p>
                <p class="enemy-tips">Strategy: Eliminate quickly before they can swarm you. They're weaker but dangerous in groups.</p>
              </div>
            </div>

            <div class="enemy-card level2-content">
              <img src="/Peter_Griffin.png" alt="Peter Griffin">
              <div class="enemy-info">
                <h3>Peter Griffin</h3>
                <p class="enemy-type">Boss Enemy - Level 2</p>
                <p class="enemy-stats">Health: 500 HP</p>
                <p class="enemy-stats">Attack: 3 damage/hit</p>
                <p class="enemy-stats">Special Abilities: Reality Manipulation</p>
                <p class="enemy-description">A dangerous foe who bends reality itself. Can spawn deadly exits and Windows logos that blind and damage players.</p>
                <p class="enemy-tips">Strategy: Stay above 5 HP to survive Windows logo attacks. Avoid all exits as they cause instant death.</p>
              </div>
            </div>
          </div>

          <!-- Power-ups Tab -->
          <div id="powerups-tab" class="tab-content">
            <div class="powerup-card">
              <img src="/Item_Glock-sharedassets4.assets-616.webp" alt="Gun Power-up">
              <div class="powerup-info">
                <h3>Gun Power-up</h3>
                <p class="powerup-type">Level 1 Power-up</p>
                <p class="powerup-duration">Duration: 30 seconds</p>
                <p class="powerup-stats">Damage Boost: 40-60 damage</p>
                <p class="powerup-description">A powerful weapon that significantly increases attack damage and projectile speed.</p>
                <p class="powerup-tips">Strategy: Time your pickup carefully for maximum effect during intense battles.</p>
              </div>
            </div>

            <div class="powerup-card level2-content">
              <img src="/electric.png" alt="Force Field">
              <div class="powerup-info">
                <h3>Force Field</h3>
                <p class="powerup-type">Level 2 Power-up</p>
                <p class="powerup-duration">Duration: 20 seconds</p>
                <p class="powerup-description">Creates an impenetrable energy shield that blocks all damage and negative effects, including projectiles like trollfaces and Windows logos.</p>
                <p class="powerup-tips">Strategy: Use during intense attacks or when cornered. Blocks all incoming damage and effects!</p>
              </div>
            </div>
          </div>

          <!-- Traps Tab -->
          <div id="traps-tab" class="tab-content">
            <div class="enemy-card level2-content">
              <img src="/Exit.png" alt="Exit Trap">
              <div class="enemy-info">
                <h3>Exit Trap</h3>
                <p class="enemy-type">Environmental Hazard - Level 2</p>
                <p class="enemy-stats">Effect: Instant Death</p>
                <p class="enemy-description">A deceptive trap that appears as an exit door. Touching it results in immediate death unless protected by a force field.</p>
                <p class="enemy-tips">Strategy: Avoid at all costs! These appear more frequently as Peter's health decreases.</p>
              </div>
            </div>

            <div class="enemy-card level2-content">
              <img src="/dfom9ho-0e411c0f-e367-480b-8c90-77ea71f64628.png" alt="Windows XP Logo">
              <div class="enemy-info">
                <h3>Windows XP Logo</h3>
                <p class="enemy-type">Environmental Hazard - Level 2</p>
                <p class="enemy-stats">Effect: Halves current health & temporarily blinds</p>
                <p class="enemy-stats">Special: Instant death if health ≤ 5</p>
                <p class="enemy-description">A reality-bending hazard that can be placed or thrown. Creates a blinding effect and deals massive damage.</p>
                <p class="enemy-tips">Strategy: Maintain health above 5 HP and use force fields to protect against them.</p>
              </div>
            </div>

            <div class="enemy-card level2-content">
              <img src="/trollface (2).png" alt="Trollface">
              <div class="enemy-info">
                <h3>Trollface</h3>
                <p class="enemy-type">Projectile Hazard - Level 2</p>
                <p class="enemy-stats">Damage: 10 per hit</p>
                <p class="enemy-description">A menacing projectile thrown by Peter Griffin. Moves quickly and deals consistent damage.</p>
                <p class="enemy-tips">Strategy: Keep moving and watch Peter's attack patterns to dodge effectively.</p>
              </div>
            </div>
          </div>
        </div>
        
        <button id="return-to-menu" class="return-button">Return to Menu</button>
      </div>
    </div>

    <!-- Game Screen (Initially Hidden) -->
    <div id="game-screen" class="game-screen hidden">
      <canvas id="gameCanvas"></canvas>
      <div id="game-ui">
        <div id="health-bar">
          <div id="health-fill"></div>
        </div>
      </div>
      <div class="mobile-controls">
        <div class="movement-pad"></div>
        <div class="shoot-button">🎯</div>
      </div>
    </div>

    <!-- Game Over Screen -->
    <div id="game-over-screen" class="hidden">
      <div class="game-over-menu">
        <h2 id="game-over-title"></h2>
        <button id="return-to-select">Return to Character Select</button>
      </div>
    </div>

    <!-- Add after level 2 completion message -->
    <div id="completion-message" class="completion-message hidden">
      <h2>Congratulations!</h2>
      <p>You've completed all currently available levels!</p>
      <p>More levels coming soon...</p>
      <p>New character unlocked: Chill Guy!</p>
      <p>Feel free to keep playing with the Level Select and explore the Repository.</p>
    </div>
  </div>
  
  <audio id="background-music" loop>
    <source src="/Elevator Music.mp3" type="audio/mp3">
  </audio>
  
  <audio id="battle-music" loop>
    <source src="/05. Loonboon.mp3" type="audio/mp3">
  </audio>
  
  <audio id="vine-boom">
    <source src="/vine-boom.mp3" type="audio/mp3">
  </audio>
  
  <script>
    // Check if level 2 content should be visible
    function updateLevel2Content() {
      const level2Content = document.querySelectorAll('.level2-content');
      const isUnlocked = localStorage.getItem('level2ContentUnlocked') === 'true';
      level2Content.forEach(element => {
        element.style.display = isUnlocked ? 'flex' : 'none';
      });
    }
    
    // Update visibility on page load and after any potential unlocks
    document.addEventListener('DOMContentLoaded', () => {
      updateLevel2Content();
      
      const levelSelectButton = document.getElementById('level-select-button');
      const levelSelectMenu = document.getElementById('level-select-menu');
      const levelButtons = document.querySelectorAll('.level-button');
      const closeMenu = document.querySelector('.close-menu');
      
      levelSelectButton.style.display = 'none'; // Ensure hidden by default
      
      // Check if level 2 is unlocked to show the button
      if (localStorage.getItem('level2Unlocked') === 'true') {
        levelSelectButton.style.display = 'block';
      }
      
      // Check selected level immediately on page load
      const selectedLevel = localStorage.getItem('selectedLevel') || '1';
      if (selectedLevel === '2') {
        document.getElementById('level1-brief').classList.add('hidden');
        document.getElementById('level2-brief').classList.remove('hidden');
      } else {
        document.getElementById('level1-brief').classList.remove('hidden');
        document.getElementById('level2-brief').classList.add('hidden');
      }
      
      levelSelectButton.addEventListener('click', () => {
        levelSelectMenu.classList.remove('hidden');
        
        // Update level button availability
        levelButtons.forEach(button => {
          const level = parseInt(button.dataset.level);
          const maxUnlockedLevel = localStorage.getItem('level2Unlocked') === 'true' ? 2 : 1;
          
          if (level <= maxUnlockedLevel) {
            button.classList.remove('locked');
            button.disabled = false;
          } else {
            button.classList.add('locked');
            button.disabled = true;
          }
        });
      });
      
      closeMenu.addEventListener('click', () => {
        levelSelectMenu.classList.add('hidden');
      });
      
      levelButtons.forEach(button => {
        button.addEventListener('click', () => {
          const level = button.dataset.level;
          localStorage.setItem('selectedLevel', level);
          levelSelectMenu.classList.add('hidden');
          
          // Show appropriate mission brief
          if (level === '1') {
            document.getElementById('level1-brief').classList.remove('hidden');
            document.getElementById('level2-brief').classList.add('hidden');
          } else {
            document.getElementById('level1-brief').classList.add('hidden');
            document.getElementById('level2-brief').classList.remove('hidden');
          }
        });
      });
    });
    
    window.addEventListener('storage', updateLevel2Content);
  </script>
  
  <script>
    const getCharacterDescription = (character) => {
      const descriptions = {
        'Steve': {
          description: "This blocky hero breaks the mold! Armed with unlimited cake slices from his inventory, Steve brings a taste of Minecraft mayhem to the battlefield. Who knew dessert could be so dangerous?",
          baseDamage: "10-30"
        },
        'Among Us': {
          description: "Looking pretty sus with those apples! This crafty crewmate turns emergency meetings into food fights, yeeting golden apples at anyone who looks even slightly suspicious.",
          baseDamage: "10-30"
        },
        'Roblox Noob': {
          description: "Money talks, but tickets fly! This classic Roblox champion makes it rain with old-school Tix, proving that discontinued currency can still pack a punch.",
          baseDamage: "10-30"
        },
        'Mario': {
          description: "It's-a him, Mario! Trading Bowser-bonking for pipe-throwing, our favorite plumber brings his trademark enthusiasm to a whole new type of pipe-based problem solving.",
          baseDamage: "10-30"
        },
        'Chill Guy': {
          description: "The most laid-back hero around! Armed with endless Snickers bars, he believes everyone gets a little aggressive when they're hungry. His chocolate projectiles not only deal damage but also help enemies chill out!",
          baseDamage: "10-30",
          special: "Slows enemies to 50% speed for 3 seconds"
        }
      };
      return descriptions[character];
    };
  </script>
  
  <script type="module" src="game.js"></script>
</body>
</html>